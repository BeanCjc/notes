# 计算机网络知识
## 1 提纲

### 1.1 什么是Internet

层次性结构是网络结构的基础，下层为上层提供服务，上层完善整个网络结构
应用层交换应用报文，实现各种各样的应用。http协议、ftp协议等各种协议
传输层完成进程到进程的可靠传输，传输tcp/udp协议报文
网络层完成端到端（主机到主机）的不可靠传输，传输ip数据报（ip协议），路由器（R），防火墙
数据链路层完成点到点（比如交换机到交换机等）的传输，传输帧，网卡、交换机（sw）
物理层将0、1数据和物理信号（光信号、电信号等）之间相互转换并传输

从构成的角度来说，互联网：节点和边
节点：主机节点、数据交换节点（中继器、交换机、路由器）
边：接入的链路、骨干链路、协议
协议：对等层的实体，在通信的过程中应该遵守的规则的集合，协议定义了在两个或多个通信实体之间交换的报文格式（语法、语义）和次序，以及在报文传输或接收或其他事件方面所采取的动作

从服务的角度来说，互联网可以是分布式应用进程和为分布式应用提供通信的基础设施（应用层以下所有）
基础设施通过面向连接的可靠服务或者面向无连接的不可靠服务对外（应用）提供服务

### 1.2 网络边缘

### 1.3 网络核心

两种数据传输方式：线路交换和分组交换

### 1.4 接入网和物理媒介

### 1.5 Internet结构和ISP（Internet Service Providers）

### 1.6 分组延时、丢失和吞吐量

延时：排队延时、处理延时（查路由表）（微妙级甚至更少）、传输延时（带宽）（微秒级到毫秒级）、传播延时（距离）（几微秒到几百毫秒 ）

两个路由之间称为一跳（hop）

TTL（生存时间）：Time To Live

RTT（往返时间）：Round Trip Time

丢失：链路的队列缓冲区容量有限，丢失的分组可能由上一跳重传（链路层可靠），可能由源主机重传（Tcp未收到应答信号），也可能不重传（UDP）

吞吐量：在源端和目标端之间传输的速率，数据量/单位时间，源端发出到目标端接收到有效的数据，吞吐量的大小取决于网络核心中有效带宽（链路可能同时被多个链接使用）最小的那一跳

瞬时吞吐量：在一个时间点的速率

平均吞吐量：在一个长时间内平均值

### 1.7 协议层次和服务模型

层次化方式实现复杂的计算机网络
每层通过层间接口向上层提供服务，实现更复杂的服务，最终实现计算机网络，层的目的是向上层提供更好的服务，层的实现是通过层间接口调用下层提供的服务。

服务：低层实体向上层实体提供他们之间的通信的能力

- 服务用户
- 服务提供者

原语（primitive）：上层使用下层服务的形式，高层使用低层提供的服务，以及低层向高层提供服务都是通过服务访问原语来进行监护的---形式

服务访问点SAP（Service Access Point）：上层使用低层服务时，低层服务区分上层服务（上层使用下层提供的服务通过层间的接口--地点）

数据单元（DU：Data Unit）

服务数据单元（SDU：Service Data Unit）

协议数据单元（PDU：Protocol Data Unit）

本层的接口控制信息（ICI：Interface Control Information）

每层的PDU称呼都不同
应用层叫应用报文（message），传输层叫报文段（segment），网络层叫分组（packet）/IP数据报（datagram）、数据链路层叫帧（frame），物理层叫位（bit）

Internet协议栈

- 应用层：网络应用，FTP、SMTP、HTTP、DNS
- 传输层：跨主机间进程传输，TCP、UDP
- 网络层：主机间的通信，端到端的通信，不可靠，IP协议、路由协议
- 链路层：相邻网络节点间的数据传输，点到点通信，点对点协议PPP、802.11（wifi），Ethernet
- 物理层：在线路上传送bit



## 2 应用层

### 2.1 应用层协议原理

寻址：协议（TCP/UDP）、IP、端口

传输层和应用层如何传输数据

进程间使用传输层的服务，实现应用进程的协议

tcp socket指的是会话关系，包含源IP、源端口、目的IP和目的端口，传输报文时发送socket标识、数据

udp socket包含本地IP，本地端口，传输报文时发送socket标识、目的IP、目的端口、数据

### 2.2 Web and Http

URL格式：protocol://user:password@hostname/route:port
协议名 用户：口令 主机名 路径名 端口

HTTP：超文本传输协议，是无状态协议，默认端口80
HTTP 1.0：RFC 1945
HTTP 1.1：RFC 2068
http1.0使用非持久连接，http1.1默认使用持久连接，多个对象可以在一个tcp连接上传输	

http报文类型：请求，响应

http请求报文：
- 请求行（get、post、head等，http1.1还增加put、delete等）：method url protocolVersion
- 首部行
- 换行回车符（表示报文结束）
- 实体数据

http响应报文：

- 状态行：protocolVersion statusCode statusCodeDescription
- 首部行
- 换行回车符
- 实体数据

cookie：维护状态，客户端第一次请求时，服务端在响应头中写入cookie并保存在服务端，客户端将响应的cookie保存；第二次客户端请求时，带上这些cookie，此时服务端就能收到客户端发过来的cookie

### 2.3 FTP

FTP：文件传输协议，RFC959，服务端默认端口21（带外传送命令），客户端默认端口20（带内传输数据），有状态协议

### 2.4 Email

三个主要组成部分：

- 用户代理，一般是客户端软件，比如outlook，foxmail
- 邮件服务器
- 简单邮件传输协议SMTP（发送的协议），POP3（Post Office Protocol）、IMAP（Internet mail access protocol）、http等（拉取的协议）

SMTP：简单邮件传输协议，RFC2821，服务端默认端口25，使用持久连接
直接传输：从发送方邮件服务器发送到目标邮件服务器
传输过程：

- tcp建立，握手

- 传输报文
- 关闭连接

报文为7位ASCII码

报文格式：

- 首部行，To、From、Subject、cc（抄送）
- 换行回车符
- 主体，报文，只能是ASCII

报文格式：多媒体编码

MIME（multimedia mail extension），RFC 2045，2056

整体的流程是：发送方用户代理通过SMTP推送-->发送方邮件服务器，再通过SMTP推送-->接收方邮件服务器-->接收方用户代理通过POP3/IMAP拉取邮件

IMAP协议更丰富，更复杂

### 2.5 DNS

DNS：域名解析服务，域名到IP的解析服务

DNS的主要思路：

- 分层的、基于域的命名方式
- 若干分布式的数据库完成名字到IP的解析
- 运行在UDP之上端口号为53的应用服务
- 核心的Internet功能，但不是在网络核心内实现的，而是在网络边缘以应用层协议实现

DNS主要目的：

- 实现主机名-IP地址的转换
- 主机别名到规范名字的转换，host aliasing
- 邮件服务器别名到邮件服务器正规名字的转换，Mail server aliasing
- 负载均衡：Load Distribution

DNS命名结构：采用层次树状结构命名
几百个顶级域（top level domains）：

- 通用的：.com .edu .cn .gov .net .mil .org .firm .hsop .web .arts .rec等
- 国家的：.cn .us .nl .jp

每个域下可划分为若干个子域（subdomains），树叶是主机名

13个根名字服务器

资源记录RR，存在DNS服务器的数据库中，每条数据包含Domain、TTL、class、value、type，class为类别，本地缓存ttl默认为2天，对于Internet值为IN。RR格式：（dimain_name, ttl, type, class, value）

- type=A
  - dimain_name为域名
  - value为IP地址
- type=CNAME
  - dimain_name为规范名字的别名
  - value为规范名字
- type=NS
  - dimain_name为域名（子域的名字）
  - value为该域名的权威服务器的域名（子域DNS服务器的域名）
- type=MX
  - dimain_name为邮件服务器的别名
  - value为邮件服务器的规范名字

DNS解析过程：

- 客户端调用解析器
- 解析器向本地DNS服务器发出查询
- DNS服务器返回响应报文

### 2.6 P2P应用

peer to peer

- 非结构化P2P
  - 集中化目录，存在单点故障、性能瓶颈、版权等问题
  - 完全分布式：所有节点构建出一个覆盖网（overlay），所有节点都一样，没有中心服务器
  - 混合体，上述两种的混合，以组和组员的形式实现
- DHT（结构化）P2P

防洪（flooding）：我向我的所有邻居发出查询，我的所有邻居也向他们的所有邻居（除了我）发出查询，以此类推，然后反向返回，以此达到向所有用户发出查询的一个目的

### 2.7 CDN

CDN（Content Distribution Networks）：内容分发网络，内容加速服务

视频的原理：由于视网膜存在滞留效应，看过某个图像后要过个几十毫秒才会消失，视频由一个个的图像构成的。
帧：表示每秒播放的图像数，例如24帧、60帧等
视频占据大量的带宽，在互联网中传输一般会采取压缩（空间压缩、时间压缩）。

CBR（constant bit rate）：以固定速率编码

VBR（variable bit rate）：视频编码率随时间的变化而变化

视频编码：AVS、MPEG1（CD-ROM）1.5Mbps、MPEG2（DVD）3-6Mbps、MPEG4（often used in internet， <1Mbps）

存储视频的流化服务：边下边播，缓冲区内的即可播放

DASH（Dynamic Adaptive Streaming over http）：多媒体流化服务
服务器：

- 将视频分割成多个块（假设每块为8-10秒的长度大小）

- 每个块独立存储，编码于不同码率（8-10种）

- 告示文件（manifest file）：提供不同块的url

客户端：

- 先获取告示文件
- 周期性的测量服务器到客户端的带宽
- 查询告示文件，在一个时刻请求一个块，http头部指定字节范围
  - 如果带宽足够，选择最大码率的视频块
  - 会话中的不同时刻，可以切换请求不同的编码块（取决于当时的可用带宽）
  - 客户端设备需求、缓冲区大小也会决定请求的文件

**对于服务器如何通过网络向上百万用户同时流化视频内容？**

**方案一**：采用单个的、大的超级服务中心“mega-server”，该方案简单，但同时存在以下一些问题：

- 客户端向服务器请求有很多跳，链路瓶颈
- 二八定律：网络中充斥着同一个视频的多个拷贝，重复流量
- 单点故障，性能瓶颈
- 周边网络拥挤

**方案二**：通过CDN，全网部署缓存节点，存储服务内容，就近为用户提供服务，提高用户体验。通过域名解析重定向，可以向最近的服务器请求资源，减少链路跳数。一般有两种缓冲位置的设置：

- enter deep：将CDN服务器深入到如多接入网
  - 离用户最近，相应最快，链路跳数极少
  - 部署节点繁多，管理困难
- bring home：部署在少数（10个左右）关键位置，链路跳数稍微多一些，也能起到加速左右，同时只需部署几个节点即可

中国的CDN服务提供商有：中国蓝汛（ChinaCache）

CDN一般流程为：

- 内容制作、内容分发（视频上传到各个CDN缓冲节点）
- 用户点击内容url（视频地址）
- DNS解析重定向至离用户最近的CDN节点
- 下载并播放视频

### 2.8 TCP套接字编程

应用进程使用传输层提供的服务才能够交换报文，实现应用协议，实现应用

- TCP/IP：应用进程使用Socket API访问传输层服务
- 地点：界面上的SAP（Socket）方式：Socket API

2种传输层服务的socket类型：

- TCP：可靠的、字节流的服务
- UDP：不可靠（数据UDP数据报）服务

套接字：应用进程与端到端传输协议（TCP或UDP）之间的门户

TCP服务：从一个进程向另一个进程可靠的传输字节流

工作过程：

- 服务器首先运行，等待连接建立

  - 创建welcome socket，返回一个整数（句柄/socket id） `socket.create`
  - 和本地IP、端口捆绑 `socket.bind(ip, port)`
  - 在welcome socket上阻塞式等待接受用户的连接 `socket.accept()`

- 客户端主动和服务器建立连接

  - 创建客户点本地套接字（隐式捆绑到本地port） `socket.create`，指定服务器进程的IP地址和端口，与服务器进程连接`socket.connect`
  - 当客户端连接请求到来时，服务器接受来自客户端的请求，接触阻塞式等待，返回一个新的connect socket（与welcome socket不一样），与客户端通信
    - 允许服务器与多个客户端通信
    - 使用源IP和源端口来区分不同的客户端
  - 连接API调用有效时，客户端与服务器建立了TCP连接

  从应用程序的角度来看：TCP在客户端和服务器进程之间提供了可靠的】字节流（管道）服务。

示例：客户端将标准输入的小写字符，通过socket，服务器将字符串转换成大写并返回给客户端

```c
struct sockaddr_in {
  short sin_family; //AF_INET，地址族，标识是TCP还是UDP
  u_short sin_port; //port，端口号
  struct in_addr sin_addr; //IP address,unsigned long
  char sin_zero[8]; //align，对齐
}
```

```c
struct hostent {
  char *h_name; //指针，主机域名
  char **h_aliases; //指针的指针，二维的，主机一系列的别名
  int h_addrtype; //
  int h_length; //地址长度，32位或其他
  char **h_addr_list; //IP地址列表
  #define h_addr h_addr_list[0]
}
//作为调用域名解析函数时的调用，输入域名，得到IP地址，将得到的IP地址拷贝到sockaddr_in的IP地址部分
```

```c
//服务器，建立welcome socket
//create socket port=x
//for incomming request
//1.welcomSocket = Socket()，返回一个数字，假设位8888
//2.bind(welcomeSocket, &sad),sad是结构体sockaddr_in，绑定本地IP和端口，假设此处服务器守护在1.1.1.1:80，客户端守护在2.2.2.2:777
//3.conncetSocket=accept(welcomeSocket)

//客户端，创建socket
//4.clientSocket = Socket()，返回一个数字，假设位2222
//5.bind(clientSocket, &cad)，cad是结构体sockaddr_in
//6.connect(clientSocket, &sad)，sad指明了服务器端的IP和port
//7.服务器返回一个应答，服务器端accept解除阻塞，同时返回一个整数（假设为8899）；此时connect返回一个有效值，clientSocket才是有效的
//8.write(clientSocket, data)
//9.服务端read(connetSocket)，返回data
//10.小写转大写并发给client，write(connectSocket)
//11.客户端read(clientSocket)
//12.服务端close(connectSocket)
//13.客户端close(clientSocket)
```

### 2.9 UDP Socket编程

UDP：在客户端和服务器之间没有连接

- 没有握手
- 发送端在每一个报文中明确地指定目标IP和port
- 服务器必须从接收到的分组中提取出发送端地IP和port

UDP：传送地数据可能乱序，也可能丢失

进程角度看UDP服务：UDP为客户端和服务器提供不可靠的字节组的传送服务



## 3 传输层

### 3.1 概述和传输层服务

传输层的工作原理：

- 多路复用/解复用
- 可靠数据传输（RDT：Reliable Data Transfer）
- 流量控制，接收方能否接收这么快的传输速度
- 拥塞控制，网络拥堵控制

传输层为上层（应用层）提供的服务是进程与进程之间的，以message为单位的逻辑通信；向下层（网络层）以段为单位进行传递数据

传输层提供的协议有TCP和UDP。

网络层提供的服务是不可靠的，TCP加强了其可靠性，有数据丢失、乱序、延迟、出错等。有的特性能加强，有的不能加强，延时和带宽问题无法加强。TCP提供可靠、保序的服务

### 3.2 多路复用和解复用

发送方主机多路复用：
从多个套接字接收来自多个进程的报文，根据套接字对应的IP地址和端口号等信息对报文段用头部加以封装（该头部信息用于以后的解复用）

接收方主机多路解复用：
根据报文段的头部信息中的IP和端口将接收到的报文段发给正确的套接字（和对应的应用程序）

### 3.3 无连接传输UDP

UDP（User Datagram Protocol）：用户数据报协议，在网络层之上没有做太多的扩展，数据报可能丢失、乱序
一般用于流媒体、DNS、SNMP等

UDP数据报的格式：

- 8个字节头部（Head），32比特；两个字节源端口，两个字节目标端口，两个字节数据长度（整个UDP报文的长度，包括头部，以字节为单位），两个字节校验和
- 报文（Payload）

EDC（Error Detection Code）：差错检测码

校验和（Check Sum）：

- 发送方

  将报文段的内容以16比特为长度进行切割并相加再进行进位取反（最高位的进位回卷）；校验和：报文段的加法和（1的补运算）；发送方将校验和放在UDP头部的校验和字段

- 接收方

  计算接收到的报文段的校验和，检查计算出的校验和与传过来的校验和的内容是否相等

残存错误：发送方计算得到的校验和与接收方计算得到的校验和不一致一定错，反之，两者一致时不一定对

发送方的校验和+接收方的校验和=FFFF，说明是对的

下面假设报文段的二进制为刚好32比特长度 1 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1，进行发送方校验和计算

   1 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0
   1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1

----

1 1 0 1 1 1 0 1 1 1 0 1 1 1 0 1 1    第一步 此时最高位溢出了一位1，回加到当前和上
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1

----

   1 0 1 1 1 0 1 1 1 0 1 1 1 1 0 0    第二步 和

----

   0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1     第三步将得到的和进行取反得到的就是发送方的校验和

接收方的校验和只做到第二步，此时两个校验和加起来为FFFF

### 3.4 可靠数据传输（RDT）的原理

停止等待协议（stop  and wait）

FSM（Finite State Machine）：有限状态机

检错重传

超时重传，发出一个packet后，定时等待ack，指定时间没收到ack，则重传。传输层和数据链路层设置超时时间的方式不同

流水线协议（pipeline protocol）：允许发送方在**未得到对方确认**的情况下一次发多个分组，必须增加需要的范围，用多个bit标识分组的序号，发送方和接收方需要有缓冲区
两种通用的流水线协议：回退N步（GBN：Go Back N）和选择重传（SR：Selective Repeat），SR可以乱序接收

滑动窗口协议（slide window），发送窗口（SW：Sending Window），接受窗口（RW：Receiving Window）

| 发送窗口大小 | 接收窗口大小 |        协议         |
| :----------: | :----------: | :-----------------: |
|     SW=1     |     RW=1     | S-W（停止等待协议） |
|     SW>1     |     RW=1     |         GBN         |
|     SW>1     |     RW>1     |         SR          |



### 3.5 面向连接的传输：TCP

TCP概述：RFC 793、1122、1323、2018、2581

- 点对点（进程到进程）：一个发送方一个接收方
- 可靠的、有序的字节流
- 管道化（流水线）：TCP拥塞控制和流量控制设置窗口大小
- 发送和接收缓存
- 全双工数据，在同一个连接中数据流双向流动，MSS：最大报文段大小
- 面向连接：在数据交换之前，通过握手（交换控制报文）初始发送方、接收方的状态变量
- 流量控制：发送方不会淹没接收方

MTU：最大传输单元，以太网最大MTU为1500Byte

MSS加上TCP的头部（20字节），传递到IP层再加上IP的头部（20字节），刚好封装到物理网络的MTU中

TCP报文段结构：

- 16比特（bit）源端口号，16比特目标端口号
- 32比特的序号（sequence，seq），以字节为编号，应用层的字节流按照MSS切分的偏移量
- 32比特的确认号（ack序号），以字节为单位，RDT中的分组序号，假设接收方发送ack=555，表示接收方已收到555之前的所有数据，发送方此时需要发送序号为555的分组数组
- 首部长度，保留未用，U，A，P，R，S，F，接收窗口（用于流量控制，表示接收方可接收的流量大小）
- 校验和（同UDP），紧急数据指针（已经不用了）
- 可选项
- 应用层数据，长度可变

超时定时器的设置：RTT采样的移动平均值+4倍的移动平均值的偏差
TimeoutInterval = EstimatedRTT + 4*DevRTT

TCP是GBN、SR的混合体

快速重传：三个冗余的ack（加上正常的一个ack算上就是四个ack）触发重传报文段，而不是等待超时定时器超时触发重传报文段

流量控制原理：接收方将自己空闲的缓冲区大小通过头部信息（接收窗口）传递给发送方，以此达到流量控制的目的

piggybacking：捎带

TCP连接管理：在正式交换数据之前，发送方和接收方握手建立关系，准备资源（准备缓冲区），初始化控制变量，告诉双方的初始序号等

连接建立三次握手：

- 客户端连接请求，标志位1（SYN=1），告诉对方自身的seq，假设为x
- 服务器连接确认ack=x+1，告诉对方自己的seq，假设为y
- 客户端确认ack=y+1

两次连接可能造成

- 服务器维持虚假的连接，或者说是服务器维持TCP连接，客户端却不维持TCP连接
- 导致服务器接收过时的数据

三次连接是由于需要确认双方选择的初始序号（seq），避免两次连接造成的问题。交换随机seq是为了避免网络中的干扰

取时钟周期的低32位作为seq，可降低先后多个TCP连接造成seq相同的情况

连接断开/四次挥手
双向断开，停止数据传输。对称释放，并不完美

- 客户端发起断开连接请求，控制报文Fin=1，同时不再发送数据，但可以接收数据
- 服务端ack，继续发送剩余的数据段
- 服务端发送完剩余的数据后，发送控制报文Fin=1，断开服务器端的TCP连接
- 客户端ack，此时不再接收数据

最后再启用一个定时器，在定时器周期内不再接收到数据，即表示该连接被关闭

### 3.6 拥塞控制原理

拥塞指的是太多的数据需要网络传输，超过了网络的处理能力，网络拥塞不加以控制可能会恶化直至瘫痪。一般表现为：

- 分组丢失
- 分组延迟

拥塞的原因：

- 大量的网络请求，超过网络带宽大小
- 路由器缓冲区没满，但滞留数据较多，发送端发触发超时重传，此时这些数据是重复的，没必要重传，因此也加剧了拥塞程度
- 路由器缓冲区满了，数据丢弃，发送端超时重传
- 较差的网络拓扑，在拥塞时数据在网络下游被抛弃，加剧网络拥塞，甚至瘫痪

拥塞控制方法：

- 端到端的拥塞控制。没有来自网络的显示反馈，端系统根据延迟和丢失时间推断是否拥塞，TCP就是采用这种方法
- 网络辅助的拥塞控制。路由器提供给端系统以返回信息，单个bit置位，显示有拥塞（SNA，DECbit，TCP/IP ECN，ATM），显示提供发送端可以采用的速率

ATM网络拥塞控制：发送端发送信元（53bit），网络中会怎么增加资源管理信元（RM）， 设置相应的控制位，到达接收端后，反馈给发送端，发送就就可以采取相应的减速行为

### 3.7 TCP拥塞控制

端到端的拥塞控制，减轻网络交换节点的负担

控制机制：路由器不向主机提供拥塞的反馈信息。端系统根据自身得到的信息判断是否发生拥塞，从而采取动作。

拥塞控制的几个问题：

1. 如何检测？拥塞程度？
2. 控制策略？如何降速？如何提速？

如何检测：

1. 超时丢失，网络拥塞（缓冲区满了，丢弃），大概率原因；出错丢弃（经过某些路由器或交换机等时发生错误，没有通过校验）。可能误判，但总体方向是对的
2. 某个段收到重复3次的ack，判定为轻度拥塞

如何控制：

Rate=CongWin/RTT bytes/sec进行粗略测量，ConggWin为拥塞控制窗口，已发送未确认的数据量；

- 超时或3个重复ack时，减小CongWin
  - 超时时：CongWin将为1MSS，进入慢启动阶段（SS，slow start阶段）后，每个RTT成倍增加CongWin，从而进入拥塞避免阶段（CA，congestion avoidance阶段），从此按照线性增加CongWin
  - 3个重复ack时，CongWin降为CongWin/2，CA阶段
- 否则（正常收到ack，无上述以上两种情况）CongWin增加：
  - SS阶段：每个RTT成倍增加CongWin，指数增加
  - CA阶段：每个RTT增加CongWin，线性增加

拥塞控制和流量控制是同时作用的，发送窗口
$$
SendWin=min(CongWin, RecvWin)
$$
RecvWin为接收方缓冲区空闲的大小（字节）

连接刚建立时CongWin=1MSS，例如MSS=1460bytes并且RTT=200ms，测初始速率
$$
RateInit=1460/200=1460*8/1000/0.2=58.4kbps
$$
当连接开始时，指数性增加：每个RTT的CongWin为上一个RTT的CongWin的2倍，直到发生丢失事件

TCP拥塞控制总结：

Threshold：阈值

- 当CongWin<Threshold时，发送端出于SS（slow-start）阶段，CongWin指数增长
- 当CongWin>Threshold，发送端出于CA（congestion-avoidance）阶段，CongWin线性增长
- 当收到3个重复ack时，Threshold设置为CongWin/2，CongWin=Threshold+3
- 当发生超时事件时，Threshold=CongWin/2，CongWin=1MSS，进入SS阶段



## 4 网络层之数据平面

### 4.1 网络层导论

网络的核心，本章介绍网络层的数据平面，下一章介绍控制平面。

网络层提供的服务：

- 在发送主机和接收主机间传送段（segment）
- 在发送端将端封装到数据报中
- 在接收端，将段上交给传输层实体
- 网络层协议存在于每一个主机和路由器
- 路由器检查每一个经过它的IP数据报的头部

网络层的关键功能：

- 转发：将分组从路由器的输入接口转发到合适的输出接口，相当于通过单个路口。路由器插着很多网卡，介入到不同的物理网络当中，在众多不同物理网络中来完成IP分组的解封装，选择路径，再封装成目标网络的帧，再把它发出去。转发就是路由器不同的端口接收数据再通过另一个端口将数据发出去。局部的功能。转发是数据平面的功能
- 路由：使用路由算法来决定从发送主机到目标接收主机的路径，涉及到路由选择算法和路由算则协议。相当于路径规划。全局的功能。路由时控制平面的功能

路由和转发相互配合，最终实现源主机到目标主机数据报的传递

**数据平面**：是本地的功能。决定从路由器输入端口到达的分组如何转发到输出端口，转发的功能分为传统方式和SDN（software-defined networking）方式。传统方式是基于目标地址+转发表（路由表），传统方式仅有转发动作；而SDN方式是基于多个字段+流表，SDN方式下有转发、block、防洪、修改某些字段等动作

**控制平面**：是网络范围内的逻辑。决定数据报如何在路由器之间路由，决定数据报从源到目标主机之间的端到端的路径。控制平面方法分为传统的路由算法：在路由器中被实现，和SDN：在远程的服务器中实现

流表是网络操作系统算出来的，通过南向接口交给分组交换设备，分组交换设备装载流表，对到来的分组做多个字段的匹配，匹配上后按照匹配项的总做表项执行响应的动作。

传统方式下每个路由器既实现数据平面功能也实现控制平面的功能，两者是紧耦合的，控制平面是分布式的。

SDN方式：逻辑集中的控制平面，一个不同的（通常是远程的）控制器与本地控制代理（CAs）交互。集中式的，可编程的。

路由器在SDN方式下称为分组交换机（Packet Switch），交换机一般是数据链路层的设备

网络服务模型：网络向上层提供服务的指标，众多指标的一个合集成为服务模型。这些指标可分为两类

- 对于单个数据报的服务
  - 可靠传送
  - 延迟保证，如少于40ms的延迟
- 对于数据流的服务
  - 保序数据报传送
  - 保证流的最小带宽
  - 分组间的延迟差

| 网络架构 | 服务模型            | 带宽               | 丢失 | 保序 | 延迟 | 拥塞反馈                |
| -------: | ------------------- | :----------------- | ---- | ---- | ---- | ----------------------- |
| Internet | best effort         | none               | no   | no   | no   | no（inferred via loss） |
|      ATM | CBR（恒定速率）     | constant rate      | yes  | yes  | yes  | no congestion           |
|      ATM | VBR（变化速率）     | guaranteed rate    | yes  | yes  | yes  | no congestion           |
|      ATM | ABR（可用比特率）   | guaranteed minimum | no   | yes  | no   | yes                     |
|      ATM | UBR（不指明比特率） | none               | no   | yes  | no   | no                      |

网络层的连接建立和传输层的连接建立是不一样的。传输层是体现在主机和主机（称为面向连接），网络层是体现在主机和主机以及中间的网络交换设备（称为有连接）

### 4.2 路由器组成

高层面（极简）通用路由器体系架构

- 路由：运行路由选择算法/协议（RIP，OSPF，BGP），生成路由表
- 转发：从输入到输出链路交换数据报，根据路由表进行分组转发

### 4.3 IP Internet Protocol

**IP协议**实现数据平面转发功能，规定了地址约定、数据报格式、分组处理约定

ICMP协议（Internet Control Message Protocol）：信令协议，用于报告错误

IP数据报格式：20字节的固定头部+可变option，以下介绍ipv4

- 4bit的版本号（ipv4或ipv6），4bit head length（头部20字节+option（以四个字节为单位）），8bit type of service（payload的类型，现在基本不用），16bit数据报length
- 16bit标志位，4bit flags，12bit fragment offset，这一行的四个字节分片用的
- 8bit的ttl，upper layer（上层协议将payload交给TPC还是UDP），16bit的头部校验和
- 32bit的源IP
- 32bit的目标IP
- option
- data，上层传下来的数据

分片的作用：大的MTU无法在以太网中传输（以太网的MTU为1500字节），所以需要进行分片，将MTU的帧头分别拼接在各个分片的头部上进行传输，此时需要对各个分片进行标序以便接收端能够知道如何进行分片重组，这个序号用偏移量来标识，以八个字节为单位，例如1480字节/8=185，所以第二个分片头部中设置的偏移量为185，第三个分片头部中设置的偏移量为370。之后到了目标主机后再进行重组，而不是下一个路由器进行重组，以此减轻路由器的负担。其中有个fragflag标志位，为1时表示还有后续的分片，为0表示这一分片是最后一个分片

IP地址：32bit标示，对主机或者路由器的接口编址，路由器一般两个机器以上IP地址

接口：主机/路由器和物理链路的连接处，路由器通常有多个接口，主机也可能有多个，IP地址和每一个接口关联

子网（subnets）：

- IP地址前缀是一样的，具备同样的子网号
- 子网内部传递数据不需要经过路由器，一条可达

IP地址分类：

A类：地址的最高位为0，紧接的7bit网络号，后面三个字节主机号，总共128-2（全0和全1的地址不用）网络号，每个网络号有2^24个主机，全球126个

B类：最高2位为10，紧接的后面14bit为网络号，后16bit为主机号，总共2^14-2网络号

C类：最高3位为110，紧接的后面21bit为网络号，最后8bit为主机号，总共有254个主机号

D类：最高4位为1110，组播地址，后面是组播地址，一般都是局域网内部使用，发送给所有

E类：预留的

A类、B类、C类地址称为单播地址

路由器通过IP的网络号进行传播

一些特殊的IP地址

- 子网部分全为0，本网络
- 主机部分全为0，本主机
- 主机部分全为1，广播地址
- 127.x.x.x回路地址/测试地址，本机

内网（专网）IP地址：

- A类：10.0.0.0-10.255.255.255 mask：255.0.0.0
- B类：176.16.0.0-176.31.255.255 mask：255.255.0.0
- C类：192.168.0.0-192.168.0.0 mask：255.255.255.0

CIDR（Classless Inter Domain Routing）：无类域间路由，在任意位置定义网络号，通过32位子网掩码来表明网络号和主机号，1表示网络号，0表示主机号，例如：11111111 11111111 11111110 0000000，也可写成200.23.16.0/23，路由器拿到一个IP地址和子网掩码进行一个与操作，将网络号提取出来，进行路由表匹配并执行动作。

主机如何获得一个IP地址？

- 系统管理员分配
- DHCP（Dynamic Host Configuration Protocol）：从服务器中动态获得一个IP地址，DHCP是在UDP之上的
  - 主机上线时广播，询问是否有存活的DHCP server
  - DHCP ack
  - 主机请求IP
  - DHCP响应IP、子网掩码、网关、DNS

NAT（Network Address Translation）：网络地址转换，内网地址出去时转换成外网地址，进来的时候路由器再转换成内网地址

内网穿透：外网无法直接访问内网得某一个端口得应用

ipv6：由于ipv4，32位的地址资源有限，IP分组的校验和经过层层路由器都要重新计算，浪费资源。头部长度是40字节，传输过程不允许分片（通过ICMPv6发送错误信息，让发送方发送较小的MTU），IP地址由ipv4的32位变成了128位

报文格式：

- 4位的版本，4位的privilege（流中数据报的优先级），24位的flow label
- 16位的payload长度，8位的next hdr（下一个头部），8位的hop limit（跳的限制）
- 128位（16字节）的源地址
- 128位（16字节）的目标地址
- data

ipv4向ipv6过渡：平滑升级，也就出现了双栈协议，同时支持ipv4和ipv6。在路由器之间建立虚拟隧道（tunneling），连接各个ipv6的孤岛，实现ipv6孤岛和ipv6孤岛的连接。随着设备的升级，孤岛数量越来越多，直达有一天ipv4减少至无，要实现全部ipv6还只是个愿景

### 4.4 通用转发和SDN

路由器的网络层功能：

- IP转发：对于到来的分组按照路由表决定如何转发，数据平面功能
- 路由：决定路径，计算路由表，控制平面功能

其他种类的网络设备：交换机、防火墙、NAT、负载均衡设备

交换机是根据源mac和目标mac进行数据交换

防火墙是根据源IP、源port、目标IP和目标port进行数据交换



## 5 网络层之控制平面

### 5.1 导论

路由选择算法，Internet自治系统内部的路由选择，常见路由协议（协议），ICMP：因特网控制报文协议，网络管理和SNMP

### 5.2 路由选择算法

路由选择算法：

- link state（链路状态路由算法，简称LS），基于Dijkstra算法
- distance vector（距离矢量路由算法简称DV），基于动态规划算法

路由选择算法实现路由功能，实现代价最小的路由选择，包括跳数、时间、拥塞程度、费用等。

路由选择协议的目标：确定从发送主机到接收主机之间，通过路由器的网络”较好“的路径。

路由器间信息计算可以理解为子网和子网间的计算。

汇集树（sink tree）：

- 此节点到所有其他节点的最优路径形成的树
- 路由选择算法就是为所有路由器找到并使用汇集树

路由算则算法的原则：

- 正确性和完整性
- 简单性，复杂的算法可能时间上延迟较大，不实用
- 健壮性（鲁棒性），能够适应通信量和网络拓扑的变化
- 稳定性，产生的路由不应该摇摆
- 公平性，对每一个站点都公平
- 最优性，某个指标上最优，时间上、费用上或综合指标

全局路由信息：所有的路由器拥有完整的拓扑和边的代价信息，link state算法

分布式（局部）路由信息：路由器只知道与它有物理连接关系的邻居路由器，和到响应邻居路由器的代价值，迭代地与邻居交换路由信息、计算路由信息，distance vector算法

路由选择算法也分为静态和动态的，但目前大部分都是自适应动态变化的，能够适应网络拓扑的变化

**LS路由**的工作过程：

- 各点通过各种渠道（某个节点获取其周边邻居及相应代价等信息，同时周边邻居也做这样的事，也就是全网泛洪）获得整个网络拓扑，网络中所有链路代价等信息。防洪是由状态的：节点向周边邻居广播获取路由信息，收到某个邻居的路由信息后需要发送ack给该邻居，同时需要发送这个邻居的路由信息给其他的邻居，其他邻居也需要发送ack回来。
- 使用LS路由算法（Dijkstra算法：一个节点到其他所有节点得最短路径算法），计算本节点到其他节点的最优路径（汇集树），得到路由表
- 按照此路由表转发

由于节点的边代表的是链路拥塞的程度，所以会存在震荡的情况

**DV算法**的基本思想：各路由器维护一张路由表，各路由器与相邻路由器交换路由表（定期或者按照一定规则的事件进行交换距离矢量），根据获得的路由信息，更新路由表。递归迭代，最终收敛到一个真实的情况节点x到y的最小代价Dx(y)，其中v为邻居节点
$$
D_x(y)=D_v+D_x(v)
$$



### 5.3 因特网中自治系统内部的路由选择

- RIP（Routing Information Protocol）协议
- OSPF（Open Shortest Path First）协议

RIP采用DV算法。距离矢量为跳数；最大跳数为15，查过15即认为不可达；每隔30s通告一次，也就是向邻居交换距离矢量；每个距离矢量最多包含25个子网；180s没收到通告即认为不可达

RIP是以进程的方式实现：route-d(daemon)，还借助传输层（tcp）来传输距离矢量

OSPF：采用LS算法。LS分组在网络中分发，全局网络拓扑、代价在每一个节点中都保持；路由计算采用Dijkstra算法；通告信息会传遍AS（路由器区域）全部（泛洪），在IP数据报上直接传送OSPF报文，而不是通过UDP或者TCP

**内部网关协议侧重效率性能**

### 5.4 ISP之间的路由选择：BGP

自治区间的路由选择，诚信路由。BGP（Bound Gateway Protocol）：边界网关协议

互联网划分区域，区域内可以自己采用路由选择算法、协议等，运行内部网关协议；每个区域作为一点节点，区域间（节点间）运行外部网关协议，区域间运行BGP协议。

**层次化路由**

BGP提供给每个AS两个方法：

- eBGP：从相邻的ASes那里获得子网可达信息
- iBGP：将获得的子网可达信息传遍到AS内部的所有路由器

网关路由器同时运行eBGP和iBGP协议

BGP会话：2个BGP路由器（peers）在一个半永久的TCP连接上交换BGP报文。

区域间的路由更加注重策略，网关路由器间如何交互遵守策略

网关路由器获取某一个子网X可能存在多条路径，在多个eBGP会话上不一定取代价最小的那个会话，而是要遵循策略进行eBGP会话选择来达到子网X。

使用TCP交换BGP报文，详细报文很复杂。

**外部网关协议侧重策略，政治策略、经济策略等**



### 5.5 SDN控制平面

SND控制器（网络OS）

传统方式存在网络行为固化、分布化、低效、网络设备复杂、难以管理等问题。2005年之后，采用SDN，用远程的方法实现集中化的控制平面（网络操作系统），网络操作系统计算出流表通过南向接口传递给各个网络操作设备，网络设备存储下流表，用于后续流表匹配以及匹配上的执行动作。分组交换机上报状态，网络操作系统下发流表。

开放实现，各厂商实现统一的协议（开放接口），开发各式各样的设备、操作系统、网络应用等。

- **南向接口**：用于网络操作系统和网络设备间的接口，主流的是通过OpenFlow。

- **北向接口**：用于网络操作系统和网络应用间的接口，网络控制应用可以实现负载均衡的功能、交换机的功能、路由器的功能、接入控制（防火墙）的功能以及其他功能。网络控制应用是在北向接口之上的。

网络OS逻辑上集中，物理上是分布式的。



## 6 数据链路层和局域网

### 6.1 引论和服务

本章主要以链路层为主，也会设计物理层，物理层偏向通信方面。

网卡一般实现链路层和物理层的功能，是紧密捆绑的。

目标：

原理：

- 检错和纠错
- 共享广播信道：多点接入（多路访问）
- 链路层寻址
- LAN：以太网（802.3）、VLANS（虚拟局域网）、WLAN（802.11）
- 可靠数据传输，流量控制

实例和各种链路层技术的实现

点到点连接一般用于广域网，多点连接一般用于局域网。家用的网线接到光猫属于点到点连接。广域网不用多点连接，原因是物理上的限制不好布局，带宽大、延迟大、碰撞概率大。

术语：

- 节点：主机、路由器，都叫节点
- 链路：把节点连在一起的链路。有线链路、无线链路。点到点链路、多点连接链路
- 帧：链路层协议数据单元

数据报（分组）在不同的链路上以不同的链路协议传送：

- 第一跳链路：以太网
- 中间链路：帧中继链路
- 最后一跳802.11

链路层提供的服务：

- 成帧：封装成帧
- 在相邻两点完成可靠传输
- 流量控制
- 错误检测
- 差错纠正
- 半双工和全双工：半双工：链路可以双向传输，但一次只有一个方向

网卡（网络适配器）实现链路层和响应的物理层，接入到主机的系统总线上，网卡可以同时发送和接收数据。

### 6.2 差错检测和纠正

CRC：循环冗余校验码，广泛应用于802.3、802.11等协议中

- 模2运算（异或运算）

- 比特序列的两种表示

  - 位串表示：1 0 1 1 

  - 多项式表示方式：$1*x^3 + 0*x^2 + 1*x^1 + 1*x^0 = x^3 + x + 1$

- 生成多项式G，双方约定的一个序列，r次方的一个序列，总共r+1位

- D+EDC，EDC r位的冗余位
  - 发送方发送D+EDC
  - 接收方接收到的(D+EDC)/G，要是能够整除就说明数据在传输过程中没有出错

r为得冗余位计算：将D左移r位（右侧补零），然后除以多项式，最后得到得余数就是R，其中每次减法采用模2运算：$R=\frac {D\cdot2^r}{G}$

示例：假设D：101110，生成多项式G为: $G=x^3+1$
也就是G为1001，那么r位的冗余位R的计算如下：
将D左移r位（3位）得到101110000，然后除以G（1001）
<img src="./images/CRC.JPG" alt="CRC" style="zoom:15%;" />

所得到的R为011，所以最后传输的D+EDC为：101110011

### 6.3 多点访问协议（MAP）

多点连接网络：同轴电缆、WLAN都是多点连接网络

多路访问协议（介质访问控制协议：MAC）：是一种用分布式的算法，解决如何使用共享信道问题，避免冲撞

MAC协议分类：

- 信道划分：把信道划分成小片（时间、频率、编码），分配片给每个节点专用
- 随机访问：信道不划分，允许冲突，冲突后恢复
- 依次轮流：节点依次轮流，但是有很多数据传输的节点可以获得较长的信道使用权

CSMA（Carrier-Sence Multiple Access）：载波侦听多路访问

CSMA/CD：冲突检测，事前侦听，边发边侦听（检测信号强度是否大于初始的信号强度），以太网/有线网络就是采用这种方式

CSMA/AC：冲突避免，事前侦听，发送过程不做冲突检测，WLAN/无线网络采用这种方式

CSMA/CD、CSMA/AC还是会存在极低概率的冲突

time slot：时隙、时槽

二进制指数退避：选择一个随机的时间，等待一个随机窗口时间再发送帧，该随机冲突的概率极低。

### 6.4 LANs

MAC地址和ARP

- 32位IP地址：网络层地址，用于将数据报传输至目标节点，IP地址是分层的
- LAN（MAC/物理/以太网）地址：链路层地址，用于使帧从一个网卡传递到与其物理连接的另一个网卡，48位MAC地址固化在适配器的ROM中，有时也可通过软件设定，理论上全球任务两个网卡的MAC地址都不相同，e.g.：68-77-24-FA-29-D1；MAC地址平面的

MAC地址有IEEE管理和分配，制造商购买MAC地址空间（范围），所以可以根据MAC查到对应设备的制造商

ARP（Address Resolution Protocol）：地址解析协议，将IP地址转换成MAC地址

RARP（Revert Address Resolution Protocol）：将MAC地址转换成IP地址

以太网（Ethernet）是目前主流的LAN技术，30元100Mbps

以太网的物理拓扑：

- 总线型：所有节点在一个碰撞域内，一次只允许一个节点发送，可靠性差，如果介质损坏，截面形成信号反射，发送节点会误认为是冲突
- 星型：目前主流，连接选择集线器（hub）或者交换机（switch），交换机比起集线器表现更优秀。现在一般是交换机在中心，每个节点以及相邻的交换机端口使用的独立的以太网协议（不会和其他节点的发送发送碰撞），交换机可以解决高负载时高碰撞的问题

以太帧数据报结构：

- 7位的前导码，用来同步接收方和发送方的时钟速率，从而可以按照发送端的时钟来接收所发送的帧
- 6字节目标MAC地址
- 6字节源MAC地址
- type：标识网络层是什么协议，IP协议或者IPX协议或者Apple Talk或者其他
- payload（上层传递下来的）
- CRC

以太网提供的是无连接、不可靠的服务，以太网的MAC协议：采用二进制指数退避的CSMA/CD介质访问控制形式

以太网标准：

- 相同的MAC协议和帧结构
- 不同的速率：2Mbps、10Mbps、100Mbps、1Gbps、100Gbps
- 不同的物理层标准
- 不同的物理层媒介：光纤、同轴电缆、双绞线

Hubs本质上是物理层的中继器

- 从一个端口收，转发到所有其他端口
- 速率一致
- 没有帧的缓存
- 在hub端口上没有CSMA/CD机制（适配器检测冲突）
- 提供网络管理功能



网络交换设备：

1. **集线器**：外形和交换机差不多，一个铁盒子，很多端口，一个端口收，其他所有端口发。hub可以接主机、可以级联（接hub，但要求同类型的hub）
2. **交换机**：集线器的升级，一个端口收，另一个端口发（根据收到的帧进行帧头判断，拿到目标MAC地址），同时允许多对收发，交换机也能级联。主机接到交换机上是点到点的连接，如果交换机或者集线器接入到交换机是多点连接。交换机内有一个交换表，存储MAC地址、端口、时戳（TTL），收到帧，解析帧头的目标MAC地址，查询交换表，找到对应端口，从该端口发出去；交换表通过自学习（self learning）得到：交换机有48个端口，连着48太设备，然后这些设备发送到对应的端口时，该交换表的一条数据就可以记下来。时戳类似TTL，隔一段时间将该条数据删除，重新进行捆版获取。

交换机是链路层（L2）的存储转发设备

路由器是网络层（L3）的存储转发设备

常见企业的网络拓扑：

- 运营商的ISP连着有防火墙的路由器，路由器连着连着交换机，交换机连着交换机，交换器连着主机/服务器



## 8 网络安全

### 8.0 概述

- 网络安全的原理，加密原理
- 认证
- 报文的完整性
- 密钥分发和证书
- 访问控制：防火墙
- 各个层次的安全性

### 8.1 网络安全的原理

什么是网络安全，包括以下几个方面：

- 私密性：只有发送方和接收方能力理解传输的报文内容，发送方加密报文，接收方解密报文
- 可认证性：发送方和接收方需要确认对方的身份
- 报文完整性：发送方和接收方需要确认报文在传输过程中或时候没有被改变
- 访问控制和服务的可用性：服务可以接入以及对用户而言是可用的

### 8.2 加密原理

对称密钥密码学（对称加密）：发送方和接收方的密钥相同

公开密钥密码学（非对称密钥加密）：发送方使用接收方的公钥进行加密，接收方使用自己的私钥进行解密

对称加密：DES，国际标准，相对安全，56位对称密钥，64位明文输入（密文切割成每64位一段，进行成对加密）；AES，更安全，128位、192位、256位key。对称密钥有密钥分发的问题。

非对称加密：公钥封装在证书里，也就是说证书里有公钥信息；RSA，用的最多，最著名。

两个很大的质数p、q，$n=p*q$，$z=(p-1)*(q-1)$、选择一个e（与z的互质），再选一个d，使得ed-1能够被z整除，（n，e）公钥，（n，d）私钥，mod为取模运算，例如触发表示$$7\div3=2...1$$，取模表示$$7mod3=1$$
对明文m加密：$$c=m^emodn$$
解密：$$m=c^dmodn$$

对称加密加解密快，非对称加密加解密慢

### 8.3 认证

使用非对称加密交换对称加密的公钥，然后使用对称加密进行加密传输密文

### 8.4 报文完整性

通过数字签名实现报文完整性，非对称加密签名。使用私钥加密签名，对方使用公钥验签。

### 8.5 密钥分发和证书

根证书是安装操作系统时嵌入到主机中，根证书可以给其他实体颁发证书，以此该实体可以为其他实体颁发证书，形成一个证书链

### 8.6 各个层次的安全性

1. 安全电子邮件

通过协商产生随机的对称密钥，发送方计算报文的摘要信息（采用摘要算法），并使用私钥进行加密生成签名，之后将报文和签名使用对称密钥加密进行传输。接收方接收到密文后使用对称密钥解密，计算报文的摘要信息，同时使用发送方的公钥进行签名验证，解密出来摘要信息和算出来的摘要信息一致，说明接收正确。该方式属于双向认证，交换双方的证书（公钥）

2. SSL（Secure sockets layer）

现在已慢慢退场，相应的方案时TLS。基于TCP的应用提供传输层的安全性，所提供的安全服务时服务器的可认证性，数据加密以及可选的客户端的可认证性。

3. 网络层的安全性

IP协议之上，认证头部协议（AH）、封装安全载荷（ESP），ESP可以认为是AH的升级，AH只提供可认证性和报文完整性，ESP还提供私密性

### 8.7 防火墙

将组织内部网络和互联网络隔离开来，按照规则允许某些分组通过（进出），或阻塞掉某些分组，动作仅有放行和拒绝

分为分组过滤防火墙和应用程序网关防火墙

### 8.8 攻击和对策

防火墙分组过滤，多TCP/IP头部进行检查，不检查会话间的相关性

IDS（Instruction Detection System）：入侵检测系统

- 深入分组检查：检查分组的内容（例如检查分组中的特征串，一只公鸡数据库的病毒和攻击串）
- 检查分组间的相关性，判断是否时有害的分组
  - 端口扫描
  - 网络映射
  - DOS攻击

## 9 未来网络前沿技术

### 9.1 软件定义网络

### 9.2 命名数据网络（上）

### 9.3 命名数据网络（下）

### 9.4 移动优先网络、网络试验设施

